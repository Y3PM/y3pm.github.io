<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>数据分析神器 Excel 常用函数 | Y3.PM</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://y3pm.com/favicon.ico?v=1625219225914">
<link rel="stylesheet" href="https://y3pm.com/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-139853328-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-139853328-1');
</script>


    <meta name="description" content="在没有学习数据分析前，一直认为Office办公三件套不如iWork好用。直到后来学了用Excel做数据分析，才发现这绝对是个神器（虽然某些时候仍然很难用）。学习中用到的一些函数，整理一下。

清洗处理类
主要是文本、格式以及脏数据的清洗和转..." />
    <meta name="keywords" content="数据分析,Excel" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://y3pm.com">
        <img src="https://y3pm.com/images/avatar.png?v=1625219225914" class="site-logo">
        <h1 class="site-title">Y3.PM</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="https://www.y3pm.com/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      👨‍💻 产品 | 设计 | 数据
    </div>
    <div class="site-footer">
      💬 Wechat: FansMaker | <a class="rss" href="https://y3pm.com/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">数据分析神器 Excel 常用函数</h2>
            <div class="post-date">2018-05-19</div>
            
              <div class="feature-container" style="background-image: url('https://y3pm.com/post-images/excel-function.jpeg')">
              </div>
            
            <div class="post-content" v-pre>
              <p>在没有学习数据分析前，一直认为Office办公三件套不如iWork好用。直到后来学了用Excel做数据分析，才发现这绝对是个神器（虽然某些时候仍然很难用）。学习中用到的一些函数，整理一下。</p>
<!-- more -->
<h2 id="清洗处理类">清洗处理类</h2>
<p>主要是文本、格式以及脏数据的清洗和转换。很多数据并不是直接拿来就能用的，需要经过数据分析人员的清理。数据越多，这个步骤花费的时间越长。</p>
<h3 id="trim">Trim</h3>
<p>清除掉字符串两边的空格。 MySQL有同名函数，Python有近似函数strip。</p>
<h3 id="concatenate">Concatenate</h3>
<p>=Concatenate(单元格 1，单元格 2……) 合并单元格中的内容，还有另一种合并方式是 &amp;。&quot;我&quot;&amp;&quot;很&quot;&amp;&quot;帅&quot;＝我很帅。当需要合并的内容过多时，concatenate 的效率快也优雅。 MySQL有近似函数concat。 =CONCATENATE(A1,A2,A3)=A1&amp;A2&amp;A3 =A1&amp;””&amp;A2&amp;A3</p>
<h3 id="replace">Replace</h3>
<p>=Replace（指定字符串，哪个位置开始替换，替换几个字符，替换成什么） 替换掉单元格的字符串，清洗使用较多。 MySQL中有同名函数，Python中有同名函数。</p>
<h3 id="substitute">Substitute</h3>
<p>和 replace 接近，区别是替换为全局替换，没有起始位置的概念</p>
<h3 id="leftrightmid">Left／Right／Mid</h3>
<p>=Mid(指定字符串，开始位置，截取长度) 截取字符串中的字符。Left/Right（指定字符串，截取长度）。left 为从左，right 为从右，mid 如上文示意。 MySQL中有同名函数。 =LEFT(A1,1)：从第左边开始取，取一个长度。 =RIGHT(A1,1)：从右边开始取，取一个长度。 =MID(A1,2,1)：从第二个开始取，取一个长度。</p>
<h3 id="lenlenb">Len／Lenb</h3>
<p>返回字符串的长度，在 len 中，中文计算为一个，在 lenb 中，中文计算为两个。 MySQL中有同名函数，Python中有同名函数。 =LEN(C1) =RIGHT(A1,LEN(A1)-1)</p>
<h3 id="find">Find</h3>
<p>=Find（要查找字符，指定字符串，第几个字符） 查找某字符串出现的位置，可以指定为第几次出现，与 Left／Right／Mid 结合能完成简单的文本提取 MySQL中有近似函数find_in_set，Python中有同名函数。</p>
<h3 id="search">Search</h3>
<p>和 Find 类似，区别是 Search 大小写不敏感，但支持＊通配符</p>
<h3 id="text">Text</h3>
<p>将数值转化为指定的文本格式，可以和时间序列函数一起看</p>
<h2 id="关联匹配类">关联匹配类</h2>
<p>在进行多表关联或者行列比对时用到的函数，越复杂的表用得越多。多说一句，良好的表习惯可以减少这类函数的使用。</p>
<h3 id="lookup">Lookup</h3>
<p>=Lookup（查找的值，值所在的位置，返回相应位置的值） 最被忽略的函数，功能性和 Vlookup 一样，但是引申有数组匹配和二分法。</p>
<h3 id="vlookup">Vlookup</h3>
<p>=Vlookup(查找的值，哪里找，找哪个位置的值，是否精准匹配) Excel 第一大难关，因为涉及的逻辑对新手较复杂，通俗的理解是查找到某个值然后黏贴过来。 =VLOOKUP(A12,B2:E8,2,0)</p>
<p>Tips:2 代表要查询的目标值距离 A12 值得相对位置。0 位精确匹配，1 为模糊匹配。只能匹配从匹配值开始右边的列。</p>
<p>Tips: 通过 “数据验证” 工具将某个值变成下拉列表。</p>
<h3 id="index">Index</h3>
<p>＝Index（查找的区域，区域内第几行，区域内第几列） 和 Match 组合，媲美 Vlookup，但是功能更强大。</p>
<h3 id="match">Match</h3>
<p>＝Match（查找指定的值，查找所在区域，查找方式的参数） 和 Lookup 类似，但是可以按照指定方式查找，比如大于、小于或等于。返回值所在的位置。</p>
<h3 id="row">Row</h3>
<p>返回单元格所在的行</p>
<h3 id="column">Column</h3>
<p>返回单元格所在的列</p>
<h3 id="offset">Offset</h3>
<p>＝Offset（指定点，偏移多少行，偏移多少列，返回多少行，返回多少列） 建立坐标系，以坐标系为原点，返回距离原点的值或者区域。正数代表向下或向右，负数则相反。</p>
<h2 id="逻辑运算类">逻辑运算类</h2>
<p>数据分析中不得不用到逻辑运算，逻辑运算返回的均是布尔类型，True 和 False。很多复杂的数据分析会牵扯到较多的逻辑运算</p>
<h3 id="if">IF</h3>
<p>经典的如果但是，在后期的 Python 中，也会经常用到，当然会有许多更优雅的写法。也有 ifs 用法，取代 if(and()) 的写法。 MySQL中有同名函数，Python中有同名函数。 =IF(A1&lt;\200,5%,IF(A1&lt;\1000,10%)) Tips:IF(判断条件, 成立值, 不成立值)；用$(F4) 锁定不可变的值。</p>
<h3 id="and">And</h3>
<p>全部参数为 True，则返回 True，经常用于多条件判断。 MySQL中有同名函数，Python中有同名函数。</p>
<h3 id="or">Or</h3>
<p>只要参数有一个 True，则返回 Ture，经常用于多条件判断。 MySQL中有同名函数，Python中有同名函数。</p>
<h3 id="is-系列">IS 系列</h3>
<p>常用判断检验，返回的都是布尔数值 True 和 False。常用 ISERR，ISERROR，ISNA，ISTEXT，可以和 IF 嵌套使用。</p>
<h2 id="计算统计类">计算统计类</h2>
<p>常用的基础计算、分析、统计函数，以描述性统计为准。具体含义在后续的统计章节再展开。</p>
<h3 id="sumsumifsumifs">Sum／Sumif／Sumifs</h3>
<p>统计满足条件的单元格总和，SQL 有中同名函数。 MySQL中有同名函数，Python中有同名函数。 =SUMIFS(C1:C12,A1:A2,” 李*”,B1:B2,” 员工”) =SUMIF(A1:A2,” 李*”,C1:C12) Tips：SUMIFS把求和列写在前面，条件在后面；SUMIF把条件写在前面，求和列在后面</p>
<h3 id="sumproduct">Sumproduct</h3>
<p>统计总和相关，如果有两列数据销量和单价，现在要求卖出增加，用 sumproduct 是最方便的。 MySQL中有同名函数。</p>
<h3 id="countcountifcountifs">Count／Countif／Countifs</h3>
<p>统计满足条件的字符串个数 MySQL中有同名函数，Python中有同名函数。 =COUNTIFS(C2:C7,”&gt;”&amp;B3,C2:C7,”&lt;\5000”) Tips:运算符和单元格之间用&amp;进行连接。</p>
<h3 id="max">Max</h3>
<p>返回数组或引用区域的最大值 MySQL中有同名函数，Python中有同名函数。</p>
<h3 id="min">Min</h3>
<p>返回数组或引用区域的最小值 MySQL中有同名函数，Python中有同名函数。</p>
<h3 id="mod">MOD</h3>
<p>取余操作，IF(MOD(A1,2) Tips：IF(MOD(A1,2)=0,&quot;偶数&quot;,&quot;奇数&quot;)</p>
<h3 id="rank">Rank</h3>
<p>排序，返回指定值在引用区域的排名，重复值同一排名。 SQL中有近似函数row_number()。</p>
<h3 id="randrandbetween">Rand／Randbetween</h3>
<p>常用随机抽样，前者返回 0~1 之间的随机值，后者可以指定范围。 MySQL中有同名函数。</p>
<h3 id="averagea">Averagea</h3>
<p>求平均值，也有 Averageaif，Averageaifs MySQL中有同名函数，python有近似函数mean。</p>
<h3 id="quartile">Quartile</h3>
<p>=Quartile（指定区域，分位参数） 计算四分位数，比如 1~100 的数字中，25 分位就是按从小到大排列，在 25% 位置的数字，即 25。参数 0 代表最小值，参数 4 代表最大值，1~3 对应 25、50（中位数）、75 分位</p>
<h3 id="stdev">Stdev</h3>
<p>求标准差，统计型函数，后续数据分析再讲到</p>
<h3 id="substotal">Substotal</h3>
<p>=Substotal（引用区域，参数） 汇总型函数，将平均值、计数、最大最小、相乘、标准差、求和、方差等参数化，换言之，只要会了这个函数，上面的都可以抛弃掉了。</p>
<p>参数：</p>
<p>AVERAGE101<br>
COUNT102<br>
COUNTA103<br>
MAX104<br>
MIN105<br>
PRODUCT106<br>
STDEV.S107<br>
STDEV.P108<br>
SUM109(隐藏和筛选时有区别，手动隐藏单元格时使用 109，先筛选，后隐藏)<br>
VAR.S110<br>
VAR.P111<br>
Int／Round<br>
取整函数，int 向下取整，round 按小数位取数。 round(3.1415,2)=3.14; round(3.1415,1)=3.1</p>
<h3 id="indirect">Indirect</h3>
<p>数据引用跳转</p>
<h2 id="时间序列类">时间序列类</h2>
<p>专门用于处理时间格式以及转换，时间序列在金融、财务等数据分析中占有较大比重。时机序列的处理函数比我列举了还要复杂，比如时区、分片、复杂计算等。这里只做一个简单概述。</p>
<h3 id="year">Year</h3>
<p>返回日期中的年 MySQL中有同名函数。</p>
<h3 id="month">Month</h3>
<p>返回日期中的月 MySQL中有同名函数。</p>
<h3 id="weekday">Weekday</h3>
<p>=Weekday(指定时间，参数) 返回指定时间为一周中的第几天，参数为 1 代表从星期日开始算作第一天，参数为 2 代表从星期一开始算作第一天（中西方差异）。我们中国用 2 为参数即可。 MySQL中有同名函数。</p>
<h3 id="weeknum">Weeknum</h3>
<p>=Weeknum(指定时间，参数) 返回一年中的第几个星期，后面的参数类同 weekday，意思是从周日算还是周一。 MySQL中有近似函数week。</p>
<h3 id="day">Day</h3>
<p>返回日期中的日（第几号） MySQL中有同名函数。</p>
<h3 id="date">Date</h3>
<p>=Date（年，月，日） 时间转换函数，等于将 year()，month()，day() 合并 MySQL中有近似函数date_format。</p>
<h3 id="now">Now</h3>
<p>返回当前时间戳，动态函数 MySQL中有同名函数。</p>
<h3 id="today">Today</h3>
<p>返回今天的日期，动态函数 MySQL中有同名函数。</p>
<h3 id="datedif">Datedif</h3>
<p>=Datedif（开始日期，结束日期，参数） 日期计算函数，计算两日期的差。参数决定返回的是年还是月等。 MySQL中有近似函数DateDiff。</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://y3pm.com/tag/Ez1AAcM-V/" class="tag">
                    数据分析
                  </a>
                
                  <a href="https://y3pm.com/tag/_8CC7OmTXd/" class="tag">
                    Excel
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://y3pm.com/post/proxy-ip/">
                  <h3 class="post-title">
                    代理IP的高匿、匿名、透明有何区别
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>






  </body>
</html>
